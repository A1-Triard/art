\documentclass[a4paper,14pt]{scrarticle}
\usepackage{indentfirst}
\usepackage[skip=0pt,indent=20pt]{parskip}
\usepackage[utf8]{inputenc}
\usepackage[english,russian]{babel}
\usepackage{amsmath}
\usepackage{epigraph}
\usepackage{csquotes}
\usepackage[unicode,pdftex]{hyperref}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{tikz}
\usepackage{caption}
\usetikzlibrary{arrows.meta}

\captionsetup[figure]{labelsep=period}

\newcommand\it[1]{\ifmmode\mathit{#1}\else\textit{#1}\fi}
\newcommand\bf[1]{\ifmmode\mathbf{#1}\else\textbf{#1}\fi}
\renewcommand\cal[1]{\mathcal{#1}}
\newcommand\bb[1]{\mathbb{#1}}

\DeclareMathOperator*{\rand}{rand}
\DeclareMathOperator*{\sign}{sign}

\title{Квантовая физика для людей уже знающих квантовую физику}
\author{warlock66613}

\begin{document}

\maketitle

\section{Квантовая механика и реализм}

Когда квантовая механика только создавалась, необычность и непривычность квантомеханической природы
вызвала необходимость отказаться от подхода, основанного на реализме в пользу эмпиризма и позитивизма.
Это был, по-видимому, действительно необходимый шаг, но когда начавшаяся в 1970-х годах программа
декогеренции доказала свою успешность, стало ясно, что этот шаг должен был быть временным, а
стратегически реализм выигрывает.

Тем не менее и сегодня зачастую встречаются утверждения, что <<квантовую механику нельзя понять>>
(завуалированный отказ от реализма), лозунги <<заткнись и считай>> (также может пониматься и
зачастую понимается аналогичным образом), <<нет ничего лучше копенгагенской интерпретации>>
(понимаемой опять же как отказ от реализма). На самом деле в настоящее время нет существенных
препятствий к пониманию квантовой механики, к пониманию её именно как теории о реальности, а не
теории о результатах экспериментов или человеческом знании. Также сегодня нет проблемы чтобы
понять \it{что именно мы не понимаем} в (квантовой) природе, как действовать в этих условиях,
и где примерно искать улучшение.

В первые десятилетия развития квантовой механики были созданы интерпретации~--- способы
превратить квантовую механику (понимаемую как нереалистическую теорию) в теорию реалистическую или
способы примириться с отказом от реалистической физической теории. Эти традиционные интерпретации
кочуют и по современным учебникам, но с современной точки зрения они плохи, если не сказать ужасны.
Это программу можно считать неудавшейся. Современная ситуация имеет, вопреки распространённому мнению,
проблему противоположную: у нас \it{множество} удовлетворительных интерпретаций и мы не знаем
какая из них ближе к истине. В целом понятно, что а) ситуацию нельзя кардинально улучшить без
новых экспериментальных данных, б) в отсутствие этих данных нужно понимать квантовую механику
\it{по модулю} лучших имеющихся интерпретаций. На самом деле есть интерпретация, которая по сути и есть
такой наименьший общий делитель лучших интерпретаций. У неё нет короткого названия, она основана
на так называемом формализме двух векторов состояния, и она положена в основу этого изложения. 

Почему не многомировая интерпретация? Она имеет много проблем и она не является необходимой для
понимания квантовой механики. Она играет важную роль в узких областях (например в области
изобретения новых интерпретаций), она перспективна, но современная квантовая механика~---
это механика одного мира и многомировая интерпретация не ухватывает этот аспект.

Почему не бомовская механика? Если устроить конкурс на худшую интерпретацию, она должна победить
по праву. Плохих интерпретаций много, и зачастую они находят позитивное применение в философии,
но в этой книге им не место.

Почему не интерпретация реального ансамбля? Интерпретация реального ансамбля пытается
объяснить квантовую механику. Наша цель не объяснить, а понять.

Почему не минимальная модальная интерпретация? Несмотря на определённую минимальность, она всё же
концептуально довольно сложная чтобы быть использованной как основной.

Если где-то вы найдёте рассуждения или вычисления, основанные на другой интерпретации,
их либо можно будет преобразовать в эквивалентную картину на языке интерпретации,
основанной на формализме двух векторов состояния, либо
эти рассуждения почти наверняка бессмысленны и/или выходят за рамки того, что понимается под
квантовой механикой в настоящее время.

\section{Крупномасштабная структура квантовой теории поля}

Как связаны перенормировки и регуляризации? Почему квантовая теория поля~--- это теория частиц?
Содержится ли квантовая механика в квантовой теории поля? Существует ли релятивистская квантовая
механика, и если нет (как часто утверждается), то почему она используется на практике? Почему в
квантовой теории поля сплошная S-матрица и как квантовые поля зависят от времени? Почему
Фейнман говорит, что фотон от далёкой звезды виртуальный, а другие физики пишут, что виртуальных
частиц не существует? Почему у фотона нет волновой функции?

Эти и другие вопросы будут рассмотрены в части, посвящённой квантовой теории поля.

\section{Первый подход}

Мы начнём с \it{эффективной гибридной теории}. В рамках этой теории
микроскопические объекты описываются с помощью квантовой механики, а макроскопические~--- с помощью
классической. Вопрос о применимости квантовой механики к макроскопическим объектам остаётся открытым.
Можно считать, что неявно, идейно предполагается, что это должно работать,
но из-за технических сложностей мы вынуждены
использовать гибридную теорию, где классическая механика вводится ad-hoc, независимо от квантовой.

\section{Гильбертово пространство}

Для начала нам нужен способ задать состояние системы в любой определённый момент времени.
В классической механике для этого используется фазовое пространство, точки которого являются возможными
состояниями системы. В квантовой механике используется другая конструкция: гильбертово пространство.

Напомним, что гильбертово пространство — это линейное пространство, снабжённое скалярным произведением.
Так как это линейное, то есть векторное пространство, то его элементы обычно называются векторами.
Свойства гильбертова пространства:

<\ldots>

При этом коллинеарные векторы соответствуют \it{одному и тому же} физическому состоянию. Можно было бы
сказать, что состояниям соответствуют лучи или точки на единичной сфере~--- это убрало бы означенную
избыточность. Но работать с линейным пространством проще, поэтому мы почти всегда будем использовать
его.

Осталось прояснить ещё один вопрос: нулевой вектор коллинеарен любому другому, чему же он соответствует.
Оказывается, он не соотвествует ничему, или, говоря иначе, он соответствует невозможному, нереализуемому
состоянию. Несмотря на это, нуль-вектор очень важен: существование такого вектора позволяет удобным
образом алгебраически выражать идею, что чего-то не существует, что что-то запрещено.

Для работы с гильбертовым пространством очень полезны \it{операторы}. Оператор~--- это непрерывное
линейное отображение пространства на себя.

<\ldots>

Вектора состояний ещё называтся кет-векторами. Полезно ввести сопряжённое пространство бра-векторов.

<\ldots>

Таким образом, запись \(\langle a | b \rangle\) отныне может пониматься двумя способами: как скалярное
произведение бра-вектора \(\langle a |\) на кет-вектор \(| b \rangle\) и как скалярное произведение
двух кет-векторов: \(a \equiv | a \rangle\) и \(b \equiv | b \rangle\).

\section{Спектральное разложение}

<\ldots>

\section{Эволюция замкнутой квантовой системы}

Замкнутая квантовая система эволюционирует \it{унитарно}:
\[
| \psi(t') \rangle = \hat U(t',t) | \psi(t) \rangle,
\]
где
\begin{align*}
& \hat U(t'', t) = \hat U(t'', t') \hat U(t', t), \\
& \hat U(t, t) = 1, \\
& \hat U(t', t) \hat U^+(t', t) = 1.
\end{align*}

Альтернативный способ задания закона эволюции~--- через задание специального оператора, \it{гамильтонинана}
\(\hat H\), который связан с производной вектора состояния \it{уравнением Шрёдингера}
\[
i \hbar \frac d {dt} | \psi(t) \rangle = \hat H | \psi(t) \rangle.
\]

Если гамильтониан не зависит от времени, то связь между двумя операторами~--- \(\hat U\) и \(\hat H\)~---
особенно простая:
\[
\hat U(t',t)=e^{-(i/\hbar) \hat H (t'-t)}.
\]

В общем случае подставив \(|\psi(t)\rangle = \hat U(t, 0) |\psi(0)\rangle\) в уравнение Шрёдингера,
получим полезное уравнение для \(\hat U(t,0)\):
\[
i\hbar \frac {d \hat U(t, 0)} {dt} = \hat H \hat U(t, 0)
\].

Можно наглядно представить эволюцию состояния системы точкой, движущейся с течением
времени от слоя к слою в расслоённом пространстве
\(\cal T \times \cal H\), где \(\cal T\)~--- ось времени (рис. \ref{fig:Sh}).

\begin{figure}[h]
\centering
\begin{tikzpicture}
\draw[thin, -, black] (0, 0) -- (0, 2) -- (1, 3) -- (1, 1) -- cycle;
\draw[thin, -, black] (2, 0) -- (2, 2) -- (3, 3) -- (3, 1) -- cycle;
\draw[thin, -, black] (4, 0) -- (4, 2) -- (5, 3) -- (5, 1) -- cycle;
\node (x) at (0.1, 1.7) {};
\node[circle,fill=black,inner sep=0pt,minimum size=4pt] (a) at (0.6, 1.5) {};
\node[circle,fill=black,inner sep=0pt,minimum size=4pt] (b) at (2.55, 1.95) {};
\node[circle,fill=black,inner sep=0pt,minimum size=4pt] (c) at (4.55, 1.5) {};
\draw[-{Latex[length=2mm]}] (a)  to [out=60,in=140] (b);
\draw[-{Latex[length=2mm]}] (b)  to [out=60,in=140] (c);
\draw[-{Latex[length=2mm]}] (x)  to (a);
\draw[thin, -, black] (4.55, 1.5) -- (4.75, 1.6);
\draw[thin, -{Latex[length=2mm]}, black] (-0.5, -0.5) -- (5.5, -0.5) node[right]{\(t\)};
\end{tikzpicture}
\caption{Картина Шрёдингера. Плоскости~--- копии исходного пространства состояний
\(\cal H\),
точки~--- шрёдингеровские состояния.}
\label{fig:Sh}
\end{figure}

Такой подход, где состояние системы унитарно эволюционирует с течением времени, называется
картиной Шрёдингера.

\section{Картина Гейзенберга}

Можно описывать эволюцию и иначе.
Именно, заметим, что на множестве истинных траекторий системы можно определить структуру гильбертова
пространства со следующим скалярным произведением:
\[
\langle \varphi(\cdot) | \psi(\cdot) \rangle := \langle \varphi(t) | \psi(t) \rangle,
\]
где \(t\) произвольно. Проверим корректность этого определения:
\[
\langle \varphi(t_1) | \psi(t_1) \rangle =
\langle \varphi(t_2) | \hat U^+(t_1, t_2) \hat U(t_1, t_2) | \psi(t_2) \rangle =
\langle \varphi(t_2) | \psi(t_2) \rangle,
\]
значит определение корректно.

Обозначим такое пространство истинных траекторий, порождаемых гамильтонианом \(\hat H\), как
\(\Gamma_{\hat H}(\cal T \times \cal H)\). Элементы этого пространства называются
гейзенберговскими состояниями (рис. \ref{fig:ShHeiz}).

\begin{figure}[h]
\centering
\begin{tikzpicture}
\draw[thin, -, black] (0, 0) -- (0, 2) -- (1, 3) -- (1, 1) -- cycle;
\draw[thin, -, black] (2, 0) -- (2, 2) -- (3, 3) -- (3, 1) -- cycle;
\draw[thin, -, black] (4, 0) -- (4, 2) -- (5, 3) -- (5, 1) -- cycle;
\fill (0.4, 0.9) circle(2pt);
\fill (0.8, 2.1) circle(2pt);
\fill (2.4, 1.8) circle(2pt);
\fill (2.7, 2.1) circle(2pt);
\fill (4.5, 1.1) circle(2pt);
\fill (4.6, 1.9) circle(2pt);
\draw [black] plot [smooth] coordinates {(0.2,0.8) (0.4,0.9) (2.4,1.8) (4.5,1.1) (4.7,1)};
\draw [black] plot [smooth] coordinates {(0.6,2.1) (0.8,2.1) (2.7,2.1) (4.6,1.9) (4.8,1.85)};
\draw[thin, ->, black] (-0.5, -0.5) -- (5.5, -0.5) node[right]{\(t\)};
\end{tikzpicture}
\caption{Шрёдингеровские и гейзенберговские состояния. Плоскости~--- копии исходного пространства состояний
\(\cal H\),
точки~--- шрёдингеровские состояния, линии~--- гейзенберговские
состояния, соответствующие истинным траекториям.}
\label{fig:ShHeiz}
\end{figure}

<\ldots>

Введём зависящий от времени оператор \(\hat U(t)\):
\begin{align*}
\hat U(t): \Gamma_{\hat H}(\cal T \times \cal H) & \to \cal H, \\
|\psi(\cdot)\rangle & \mapsto |\psi(t)\rangle.
\end{align*}

Используя этот оператор, запишем среднее значение произвольной наблюдаемой \(A\) в альтернативной форме:
\[
\langle \psi(t) | \hat A | \psi(t) \rangle =
\langle \psi(\cdot) | \hat U^+(t) \hat A \hat U(t) | \psi(\cdot) \rangle =
\langle \psi(\cdot) | \hat A(t) | \psi(\cdot) \rangle,
\]
где \(\hat A(t) := \hat U^+(t) \hat A \hat U(t)\).

Таким образом, у любого шрёдингеровского оператора наблюдаемой \(\hat A\), действующего на
пространстве \(\cal H\), есть соответствующий гейзенберговский оператор \(\hat A(t)\), действующий
на пространстве гейзенберговских состояний \(\Gamma_{\hat H}(\cal T \times \cal H)\).

Как задать гейзенберговское состояние? Обычный способ~--- указанием точки в пространстве
\(\cal T \times \cal H\), через которую проходит соответствующая траектория.
Мы знаем, что шрёдингеровское состояние чаще всего задаётся набором квантовых чисел \(\alpha\).
Дополнив этот набор указанием времени, к которому он относится, мы получим гейзенберговское состояние
\(|\alpha; t\rangle \equiv |\alpha\rangle_t\). Такая \it{запись} неоднозначна: одно и то же состояние
может быть представлено совершенно разными значениями квантовых чисел, относящихся к разным временам.
 
Гейзенберговские состояния обладают следущим важным свойством:
\[
\langle \varphi | \hat U(t_2, t_1) | \psi \rangle = {}_{t_2} \langle \varphi | \psi \rangle_{t_1}, 
\]
то есть амплитуда перехода из одного состояния в другое~---
это просто произведение соответствующих гейзенберговских состояний.

В картине Шрёдингера эволюция состояния при заданном гамильтониане определяется уравнением Шрёдингера.
В картине Гейзенберга должно быть аналогичное уравнение для зависящих от времени операторов наблюдаемых.
Найдём его.

Заметим, что
\[
\hat U(t) = \hat U(t, 0) \hat U(0),
\]
поэтому
\begin{multline*}
i\hbar \frac {d \hat U(t)} {dt} = \\
= i\hbar \frac {d \hat U(t, 0)} {dt} \hat U(0) = \hat H \hat U(t,0) \hat U(0) = \\
= \hat H \hat U(t) = \hat U(t) \hat U^+(t) \hat H \hat U(t) = \hat U(t) \hat H(t)
\end{multline*}
и
\begin{multline*}
i\hbar \frac {d \hat A(t)} {dt} = \\ =
i\hbar \frac d {dt} \hat U^+(t) \hat A \hat U(t) =
i\hbar \frac {d \hat U^+(t)} {dt} \hat A \hat U(t) +
\hat U^+(t) \hat A i\hbar \frac {d \hat U(t)} {dt} = \\
= -\hat H(t) \hat U^+(t) \hat A \hat U(t) +
\hat U^+(t) \hat A \hat U(t) \hat H(t) = \\ =
-\hat H(t) \hat A(t) + \hat A(t) \hat H(t).
\end{multline*}
Таким образом, имеем следующее \it{уравнение Гейзенберга}:
\[
i\hbar \frac {d \hat A(t)} {dt} = [\hat A(t), \hat H(t)] := \hat A(t) \hat H(t)-\hat H(t) \hat A(t).
\]

\section{Взаимодействие с классической системой}

Общий вид интересующей нас системы — это пара квантовая система~+~классическая система, которые большую часть
времени эволюционируют независимо, но в некоторые дискретные моменты времени контактируют друг с другом.

(Разумеется, в реальности взаимодействие квантовых и классических систем идёт непрерывно, и описанный выше
механизм есть некоторая идеализация, которой достаточно в большинстве случаев, но не всегда. Случаи,
выходящие за рамки такой идеализации, однако, удобнее рассматривать не в рамках эффективной гибридной теории,
а в рамках последовательно квантового подхода, когда даже классическая часть описывается как квантовая.)

Такая модель с двумя системами~--- квантовой и классической~--- чем-то напоминает броуновское движение,
когда непрерывное свободное движение молекул и броуновских частиц прерывается столкновениями, во время которых
состояние обоих систем меняется скачкообразно. Соответственно, нам нужно иметь некие три закона эволюции:
для замкнутой квантовой системы, для замкнутой классической и для мгновенного скачкообразного изменения
состояний взаимодействующих классической и квантовой систем.

Итак, у нас есть состояние квантовой системы, представленное вектором гильбертова пространства \(\Psi\).
И есть состояние классической системы.
Нам нужно как-то описать взаимодействие этих систем.
Такое взаимодействие обычно называют (идеальным) измерением, потому что удобно думать о классической
системе как о некотором лабораторном приборе, причём даже если дело происходит не в лаборатории, а,
например, в ранней Вселенной, задолго до появления этих самых лабораторий. Предполагается, что у прибора
есть некая шкала, дискретная или непрерывная, и прибор, предоставленный себе, сохраняет показания на этой шкале.
Удобным свойством состояния классической системы является факторизуемость: шкала~--- это подсистема, со своим
фазовым пространством, и полное фазовое пространство является прямым произведением фазового пространства
шкалы и фазового пространства остальных частей прибора. Фактически мы можем вообще забыть об остальной части.
То есть из всего набора обобщённых координат остаётся одна-единственная координата \(Q\)~--- показания шкалы
прибора. Сохранение показаний
означает, что соответствующий обобщённый импульс всегда равен нулю. Таким образом, состояние классического
прибора в простейшем случае сводится к одному действительному числу \(Q\).

Следующий момент~--- раз мы говорим об измерительном приборе, суть прибора в том, что показания \it{до}
измерения никак не влияют на показания \it{после} измерения, и показания после определяются только
состоянием квантовой системы. Если обратить направление времени, то ситуация будет выглядеть иначе.
Значит первое, что нужно задать для описания взаимодействия прибора с квантовой системой~--- это направление
времени: <<вперёд>> или <<назад>>. Об этом аспекте часто забывают, потому что в лаборатории~--- по
причинам термодинамического храрактера~--- есть выделенное направление времени
(\it{термодинамическая стрела времени}) и довольно сложно
сделать прибор, работающий \it{против него}. Казалось бы, ну и ладно, раз уж так. К сожалению, такая
<<забывчивость>> не вполне безобидна и ведёт к неверному представлению о существовании уже в квантовой механике
некоей своей, квантомеханической стрелы времени. Поэтому мы не будем преждевременно нарушать симметрию
относительно отражения времени, и рассмотрим на равных правах измерения <<вперёд>> и <<назад>>.

Следующая особенность взаимодействия классической и квантовой систем~--- это, с одной стороны,
необходимость прибегать к вероятностному языку, что необычно, поскольку~--- как можно видеть~--- к этому
нет никаких предпосылок, а, с другой стороны, невероятная успешность этого языка. Суть в том, что
состояние квантовой системы до измерения не определяет на самом деле состояние прибора после измерения, но
определяет только \it{возможные значения} и \it{вероятности} их получения. Поэтому в
искомую нами математическую модель нужно ввести формальный источник случайности. Вообще-то появление этого
источника случайности не должно быть столь уж шокирующим, учитывая все приближения которые были сделаны, и,
в первую очередь, приближение классичности прибора. Вот если при переходе к более точной модели, когда
и система, и прибор описываются квантомеханически, вероятность опять возникнет словно ниоткуда~---
вот это было бы действительно удивительно.

Наконец мы готовы математически описать взаимодействие классической и квантовой систем. Для этого надо
задать конечный или бесконечный набор моментов <<контакта>>
\(\ldots < t_{-2} < t_{-1} < t_0 < t_1 < t_2 < \ldots\)
и для каждого момента \(t_i\)
самосопряжённый оператор \(\hat Q_i\),
спектральное разложение которого \[\hat Q_i = \sum_k Q_{ik} | q_{ik} \rangle \langle q_{ik} |.\]

Тогда для прибора, измеряющего <<вперёд>>,
\begin{equation}
\left. \begin{matrix} Q(t_i + 0) \\ \Psi(t_i+0) \end{matrix} \right\rbrace =
\rand_k \left\lbrace \begin{matrix} Q_{ik} \\ |q_{ik}\rangle \end{matrix} \right| _
{ \bf P(k) = \left| \langle q_{ik} | \Psi(t_i-0) \rangle \right|^2 }
.
\label{t1}\end{equation}

И для измеряющего <<назад>>:
\begin{equation}
\left. \begin{matrix} Q(t_i - 0) \\ \Psi(t_i-0) \end{matrix} \right\rbrace =
\rand_k \left\lbrace \begin{matrix} Q_{ik} \\ |q_{ik}\rangle \end{matrix} \right| _
{ \bf P(k) = \left| \langle q_{ik} | \Psi(t_i+0) \rangle \right|^2 }
.
\label{t2}\end{equation}

Интересно, что можно даже одновременно использовать и прибор, измеряющий <<вперёд>>, и прибор, измеряющий
<<назад>>, причём так, что они не будут влиять друг на друга и (\ref*{t1}) и (\ref*{t2}) будут в силе
\it{одновременно}.

Чтобы доказать совместимость (\ref*{t1}) и (\ref*{t2}), обратимся вначале к закону эволюции квантовой системы.

\section{Эволюция замкнутой квантовой системы}

Замкнутая квантовая система эволюционирует \it{унитарно}:
\[\Psi(t') = \hat U(t',t) \Psi(t),\]
где
\begin{align*}
& \hat U(t'', t) = \hat U(t'', t') \hat U(t', t), \\
& \hat U(t, t) = 1, \\
& \hat U(t', t) \hat U^+(t', t) = 1.
\end{align*}

Этого достаточно, чтобы показать совместимость (\ref{t1}) и (\ref{t2}). Но собирая всё вместе надо быть
аккуратным. Прежде всего, надо иметь в виду, что \(k\), вообще говоря, разное для всех \(i\) и совсем
не обязательно, что \(i\)-тое \(k\) из (\ref{t1}) является \(i\)-тым и для (\ref{t2}). Фактически, они смещены
на единицу. Второй, более неожиданный момент~--- что \(\Psi\) тоже разные. Как такое может быть, если это
состояние одной и той же системы? Дело в том, что выбор 
того или другого варианта вектора состояния произволен, он не влияет на физические, наблюдаемые величины
и схож с выбором калибровки электромагнитных потенциалов в электродинамике. То есть, так же, как в значениях
потенциалов, кроме информации о реальных, физических, наблюдаемых величинах, также присутствует
дополнительная информация о выбранной калибровке, так и в векторе состояния \(\Psi\) помимо информации
о реальном, физическом состоянии квантовой системы, присутствует информация о выборе одного из
двух возможных <<направлений эволюции>>.

Имея в виду вышесказанное, соберём всё вместе:
\begin{align}
\Psi_+(t_i - 0) &= \hat U_i \Psi_+(t_{i-1}+0), \\
\Psi_-(t_i - 0) &= \hat U_i \Psi_-(t_{i-1}+0), \\
\left. \begin{matrix}
Q_+(t_i + 0) \\ Q_-(t_{i-1} - 0) \\ \Psi_+(t_i+0) \\ \Psi_-(t_{i-1}-0)
\end{matrix} \right\rbrace &=
\rand_k \left\lbrace \begin{matrix}
Q_{ik} \\ Q_{i-1,k} \\ |q_{ik}\rangle \\ |q_{i-1,k}\rangle
\end{matrix} \right| _
{ \bf P(k) = P_{ik} }
,
\end{align}
и покажем, что вероятности \(P_{ik}\) одинаковы, независимо от того, вычислять их по (\ref{t1})
(\(P_{ik} = \left| \langle q_{ik} | \Psi_+(t_i-0) \rangle \right|^2\)) или по (\ref{t2})
(\(P_{ik} = \left| \langle q_{i-1,k} | \Psi_-(t_{i-1}+0) \rangle \right|^2\)):
\begin{multline*}
\left| \langle q_{ik} | \Psi_+(t_i-0) \rangle \right|^2 =\\
= \left| \langle \Psi_+(t_i-0) | q_{ik} \rangle \right|^2
= \left| \langle \Psi_+(t_i-0) | \Psi_-(t_i-0) \rangle \right|^2
= \left| \langle \hat U_i \Psi_+(t_{i-1}+0) | \Psi_-(t_i-0) \rangle \right|^2 =\\
= \left| \langle \Psi_+(t_{i-1}+0) | \hat U_i^+ \Psi_-(t_i-0) \rangle \right|^2
= \left| \langle q_{i-1,k} | \hat U_i^+ \Psi_-(t_i-0) \rangle \right|^2 =\\
= \left| \langle q_{i-1,k} | \Psi_-(t_{i-1}+0) \rangle \right|^2
.
\end{multline*}

\section{Средние}

Как можно видеть получаемые значения измеряемой величины стохастичны
и вообще не зависят от состояния системы
(кроме важных, на частных случаев, когда вероятность равна 0 или 1). Состояние системы определяет лишь
вероятности. Но вероятности не являются непосредственно измеримыми. Правда можно (\it{если можно})
взять много копий квантовой системы в одном и том состоянии и измерить частоты, которые при большом числе копий
не должны сильно отличаться от вероятностей. Но ещё можно скомбинировать вероятности в величину,
с которой удобно работать и теоретически и практически, величину, являющуюся важной характеристикой
состояния и интересной самой по себе. Эта величина~--- среднее.

Для среднего есть красивая формула. Именно, среднее измеряемой величины, соответствующей оператору \(\hat Q\),
есть
\begin{equation}
\langle Q \rangle(t) = \langle \Psi(t) | \hat Q | \Psi(t) \rangle .
\label{av}\end{equation} (Проверяется тривиально.)

Чтобы лучше представить как состояние изменяется со временем, от простого гильбертова пространства \(\cal H\)
потребуется перейти к расслоённому пространству \(\cal T \times \cal H\), где \(\cal T\)~--- ось времени.
Тогда траектория \(\Psi(\cdot)\) системы~--- это сечение этого расслоённого пространства.

Пространство \(\cal U\) всех разрешённых траекторий (то есть траекторий, на которых выполняется закон эволюции
\(\Psi(t') = \hat U(t', t) \Psi(t)\)) тривиальным образом является линейным пространством.
Можно ввести на нём и структуру гильбертова пространства. Именно, пусть \(t\)~---
произвольный момент времени, тогда
\[
\langle \Phi(\cdot) | \Psi(\cdot) \rangle := \langle \Phi(t) | \Psi(t) \rangle.
\]

Проверим корректность такого определения. Для любых \(t_1\) и \(t_2\)
\begin{multline*}
\langle \Phi(t_1) | \Psi(t_1) \rangle = \\
= \langle \hat U(t_1, t_2) \Phi(t_2) | \hat U(t_1, t_2) \Psi(t_2) \rangle
= \langle \Phi(t_2) | \hat U^+(t_1, t_2) \hat U(t_1, t_2) | \Psi(t_2) \rangle = \\
= \langle \Phi(t_2) | \Psi(t_2) \rangle
,
\end{multline*}
следовательно определение корректно.

Хотя \(\cal T \times \cal H\) не является линейным пространством, полезно ввести на нём скалярное
произведение (пусть это и не превратит его в гильбертово).
Причём его можно ввести минимум двумя принципиально разными
осмысленными способами. Можно каждой точке \((t, \Psi)\) сопоставить
проходящую через неё траекторию \(\Psi(\cdot)\) и определить скалярное произведение точек как
скалярное произведение проходящих через них траекторий:
\[
\left.
\langle (t_1, \Psi_1) | (t_2, \Psi_2) \rangle = \langle \Psi_1(\cdot) | \Psi_2(\cdot) \rangle
\right|_{\Psi_1(t_1) = \Psi_1, \Psi_2(t_2) = \Psi_2}
.\]
А можно точке сопоставить её проекцию на \(\cal H\) и определить произведение как произведение таких проекций,
то есть
\[
\langle (t_1, \Psi_1) | (t_2, \Psi_2) \rangle = \langle \Psi_1 | \Psi_2 \rangle.
\]

Оказывается, можно строить квантовую механику, понимая под состоянием не точку, перемещающуюся по \(\cal H\)
или \(\cal T \times \cal H\), а траекторию. Состояние в смысле элемента \(\cal U\) называется гейзенберговским
состоянием, а состояние в смысле элемента \(\cal H\)~--- шрёдингеровским состоянием. Такое положение дел,
когда состояния~--- это независящие от времени сущности, траектории, называется \it{картиной Гейзенберга}
(иногда~--- неудачно, поскольку это ведёт к серьёзной путанице~--- \it{представлением Гейзенберга}),
а картина с меняющимся во времени состоянием~--- \it{картиной Шрёдингера} (иногда, соответственно,
\it{представлением Шрёдингера}).

Поскольку пространство разрешённых траекторий \(\cal U\) изоморфно \(\cal H\) (чтобы построить такой изоморфизм
достаточно выбрать произвольный момент времени \(t_0\) и определить \(\Psi(\cdot) \sim \Psi(t_0)\)), то
на гейзенберговские состояния зачастую также удобно смотреть как на элементы \(\cal H\), хотя всегда
полезно помнить, что сущностно они траектории.

Мы можем сохранить в картине Гейзенберга формулу (\ref{av}) для средних, если введём зависящий от времени
оператор \(\hat Q(t)\), и формула перепишется в виде
\begin{equation}
\langle Q \rangle(t) = \langle \Psi(\cdot) | \hat Q(t) | \Psi(\cdot) \rangle .
\end{equation}

Построить такой оператор \(\hat Q(t)\) легко, если воспользоваться изоморфизмом между \(\cal U\) и \(\cal H\).
Именно, положим \(\Psi(\cdot) \equiv \Psi(0)\). Тогда отображение
\begin{align*}
U_t: \cal U &\to \cal H, \\
\Psi(\cdot) &\mapsto \Psi(t)
\end{align*}
становится оператором, причём этот оператор есть просто \(\hat U(t, 0)\).

Аналогично, обратное отображение
\begin{align*}
U_t^{-1}: \cal H &\to \cal U, \\
\Psi(t) &\mapsto \left. \Psi(\cdot) \right|_{U_t[\Psi(\cdot)] = \Psi(t) }
\end{align*}
становится оператором \(\hat U(0, t) = \hat U^+(t, 0)\).

И тогда
\begin{align*}
| \Psi(t) \rangle &= \hat U(t, 0) | \Psi(\cdot) \rangle, \\
\langle \Psi(t) | &= \langle \Psi(\cdot) | \hat U^+(t, 0), \\
\langle \Psi(t) | \hat Q | \Psi(t) \rangle &=
\langle \Psi(\cdot) | \hat U^+(t, 0) \hat Q \hat U(t, 0) | \Psi(\cdot) \rangle,
\end{align*}
то есть \[ \hat Q(t) = \hat U^+(t, 0) \hat Q \hat U(t, 0). \]

\section{Гамильтониан}

Оператор эволюции \(\hat U(t', t)\) удобен для абстрактных рассуждений, но для
конкретных вычислений он устроен очень сложно, поэтому хорошо бы найти другой способ задавать эволюцию
квантовой системы. И такой способ есть.

Рассмотрим эволюцию на очень малом промежутке времени \(t \to t'\). Поскольку разница между \(t\) и \(t'\)
мала, разница между \(\Psi(t)\) и \(\Psi(t')\) тоже мала, а значит можно записать
\[\Psi(t') = (1+(t'-t)(-i)\hat H(t)) \Psi(t)\]
(коэффициент \(-i\) вынесен из \(\hat H(t)\) для удобства в дальнейшем).

Отсюда получаем
\[i\frac {\Psi(t') - \Psi(t)} {t'-t} = \hat H(t) \Psi(t),\]
то есть
\[i\frac d {dt} \Psi(t) = \hat H(t) \Psi(t).\]

Оператор \(\hat H(t)\) называется \it{гамильтонианом}. Он является самосопряжённым и, значит, наблюдаемой.
Фактически, он является оператором энергии.

В гейзенберговской картине эволюционируют операторы, а не состояния. Найдём соответствующее уравнение.
 
<\ldots>

\section{Роль спектра гамильтониана}

<\ldots> Поэтому найти спектр гамильтониана фактически означает решить задачу нахождения траектории для
любого начального состояния.

\section{Матрица плотности}

Зачастую нас интересует лишь часть замкнутой системы. Для классической системы описание состояния не отличается
для замкнутой системы и для открытой: в любом  случае это точка в фазовом пространстве, координаты точки~---
обобщённые координаты и импульсы системы. Для квантовой системы же ситуация несколько иная и состояние
открытой системы устроено более сложно, чем состояние замкнутой.

<\ldots>

\section{Декогеренция}

Окружающая среда может подавлять интерференционные явления в открытых системах, заставляя компоненты
волновой функции вести себя независимо. Рассмотрим простейший модельный пример.

\section{Полное описание состояния квантовой системы}

Возникновение вероятностей в момент измерения указывает на то, что вектор состояния не является
полным описанием состояния системы, то есть что две системы, имеющие один и тот же вектор состояния,
могут быть объективно различны. Ранние попытки построить полное описание состояния квантомеханической
системы путём введения некоторых т.~н. скрытых переменных были неудачны. Но в конце-концов удовлетворительное
решение было найдено. Мы уже сталкивались с двумя векторами состояния~--- \(\Psi^+\) и \(\Psi^-\).
Оказывается, если использовать их совместно, то получится полное описание.

Два вектора  могут быть объединены и заменены одним объектом~--- асимметричной матрицей плотности
\[
\hat \rho = \frac { | \Psi^+ \rangle \langle \Psi^- | } { \langle \Psi^- | \Psi^+ \rangle }.
\]

\section{Квантовый осциллятор в представлении Фока}

На практике дело осложняется тем, что зачастую мы знаем свойства гамильтониана как элемента некоторой
операторной алгебры, но не знаем правильного представления этой алгебры. Оказывается, однако, что
алгебраических свойств достаточно для восстановления гильбертова пространства.

Рассмотрим важнейший пример~--- квантовый осциллятор. Гамильтониан системы
\[\hat H = \frac {\hat p^2} {2m} + \frac {m \omega^2 \hat q^2} 2,\]
причём \(\hat q\) и \(\hat p\)~--- самосопряжённые и \[[\hat q, \hat p] = i.\]

Введём новые оператор \(\hat a\) и сопряжённый к нему, называемые лестничными:
\begin{align*}
& \hat a = \sqrt {\frac {m \omega} 2} \hat q + \frac i {\sqrt {2m \omega}} \hat p, \\
& \hat a^+ = \sqrt {\frac {m \omega} 2} \hat q - \frac i {\sqrt {2m \omega}} \hat p.
\end{align*}

Отсюда \[ [\hat a, \hat a^+] = 1,\]
\begin{align*}
& \hat q = \frac 1 {\sqrt {2m \omega}} (\hat a + \hat a^+), \\
& \hat p = -i {\sqrt {\frac {m \omega} 2}} (\hat a - \hat a^+).
\end{align*}

\[\hat H = \frac \omega 2 (\hat a \hat a^+ + \hat a^+ \hat a) = \omega(\hat a^+ \hat a + \frac 1 2).\]

Теперь легко вычислить коммутаторы \([\hat a, \hat H]\) и \([\hat H, \hat a^+]\)~--- они нам пригодятся:
\begin{multline*}
[\hat a, \hat H] = \\ = \hat a \omega(\hat a^+ \hat a + \frac 1 2) - \omega(\hat a^+ \hat a + \frac 1 2)\hat a
= \omega(\hat a \hat a^+ \hat a - \hat a^+ \hat a \hat a) 
= \omega((1 + \hat a^+ \hat a) \hat a - \hat a^+ \hat a \hat a) =\\
= \omega \hat a,
\end{multline*}
\begin{multline*}
[\hat H, \hat a^+] = \\
= \omega(\hat a^+ \hat a + \frac 1 2)\hat a^+ - \hat a^+ \omega(\hat a^+ \hat a + \frac 1 2)
= \omega(\hat a^+ \hat a \hat a^+ - \hat a^+ \hat a^+ \hat a) 
= \omega(\hat a^+ (1 + \hat a^+ \hat a) - \hat a^+ \hat a^+ \hat a) =\\
= \omega \hat a^+.
\end{multline*}

Найдём собственные значения \(\hat H\). Пусть \(|\psi_E\rangle\)~--- любой собственный вектор \(\hat H\),
а \(E\)~---соответствующее собственное значение. Посмотрим, что будет, если подействовать \(\hat H\)
на \(\hat a^+ |\psi_E\rangle\):
\[
\hat H \hat a^+ |\psi_E\rangle = (\omega \hat a^+ + \hat a^+ \hat H)|\psi_E\rangle
= \omega \hat a^+ |\psi_E\rangle + \hat a^+ E|\psi_E\rangle
= (\omega + E) \hat a^+ |\psi_E\rangle.
\]

Таким образом, \(\hat a^+ |\psi_E\rangle\)~--- тоже собственный вектор с собственным значением \(E+\omega\).
Аналогично
\[
\hat H \hat a |\psi_E\rangle = (-\omega \hat a + \hat a \hat H)|\psi_E\rangle
= -\omega \hat a |\psi_E\rangle + \hat a E|\psi_E\rangle
= (-\omega + E) \hat a |\psi_E\rangle,
\]
так что \(\hat a |\psi_E\rangle\)~--- собственный вектор с собственным значением \(E-\omega\).

Итого мы имеем бесконечный ряд равноотстоящих собственных значений. Но \(\hat H\) ограничен снизу, значит этот
ряд должен как-то прерваться. Единственный вариант как это может случиться~--- если применение \(\hat a\)
даст в какой-то момент ноль. Значит для основного состояния \(|0\rangle\) мы получаем уравнение
\[
\hat a | 0 \rangle = 0,
\]
а соответствующее значение энергии равно \(\frac \omega 2\), так как
\[
\hat H | 0 \rangle = \omega (\hat a^+ \hat a + \frac 1 2) |0\rangle = \frac \omega 2 |0\rangle.
\]

Обозначим нормированный собственный вектор с собственный значением \(n\omega + \frac 1 2\) через \(|n\rangle\).
Как мы выяснили, этот вектор имеет вид \(C_n (\hat a^+)^n |0\rangle\), где \(C_n\)~--- нормировочный
коэффициент. Найдём этот коффициент:
\begin{gather*}
\langle n|n \rangle = 1, \\
\langle 0| \hat a^n C_n^* C_n (\hat a^+)^n |0 \rangle = 1, \\
|C_n|^2 \langle 0| \hat a^n (\hat a^+)^n |0 \rangle = 1, \\
|C_n|^2 \langle 0| \hat a^{n-1} \hat a (\hat a^+)^n |0 \rangle = 1. \\
\end{gather*}

Нам нужем коммутатор \([\hat a, (\hat a^+)^n]\), найдём его:
\[
[\hat a, (\hat a^+)^n] = \hat a (\hat a^+)^n - (\hat a^+)^na = *.
\]
Начинаем продвигать \(\hat a\) вправо применяя замену \(\hat a \hat a^+ = 1 + \hat a^+ \hat a\):
\begin{gather*}
* = (1 + \hat a^+ \hat a)(\hat a^+)^{n-1} - (\hat a^+)^na = \\
= (\hat a^+)^{n-1} + \hat a^+ \hat a (\hat a^+)^{n-1} - (\hat a^+)^na = \\
= (\hat a^+)^{n-1} + \hat a^+ (1 + \hat a^+ \hat a) (\hat a^+)^{n-2} - (\hat a^+)^na = \\
= (\hat a^+)^{n-1} + (\hat a^+)^{n-1} + (\hat a^+)^2 \hat a (\hat a^+)^{n-2} - (\hat a^+)^na.
\end{gather*}
Видно, что каждая перестановка порождает слагаемое \((\hat a^+)^{n-1}\). И всего перестановок будет \(n\),
поэтому
\[
* = n(\hat a^+)^{n-1} + (\hat a^+)^n \hat a - (\hat a^+)^na = n(\hat a^+)^{n-1}.
\]
Таким образом,
\[
[\hat a, (\hat a^+)^n] = n(\hat a^+)^{n-1}.
\]

Возвращаемся к вычислению нормировочного коэффициента:
\begin{gather*}
|C_n|^2 \langle 0| \hat a^{n-1} \hat a (\hat a^+)^n |0 \rangle = 1, \\
|C_n|^2 \langle 0| \hat a^{n-1} (n(\hat a^+)^{n-1} + (\hat a^+)^n \hat a) |0 \rangle = 1, \\
n |C_n|^2 \langle 0| \hat a^{n-1} (\hat a^+)^{n-1} |0 \rangle = 1.
\end{gather*}
Повторяя процедуру, последовательно получим
\begin{gather*}
n(n-1) |C_n|^2 \langle 0| \hat a^{n-2} (\hat a^+)^{n-2} |0 \rangle = 1, \\
n(n-1)(n-2) |C_n|^2 \langle 0| \hat a^{n-3} (\hat a^+)^{n-3} |0 \rangle = 1,
\end{gather*}
и в конце
\[
n! |C_n|^2 \langle 0 |0 \rangle = 1, \\
\]
а значит (учитывая произвол фазы)
\[
C_n = (n!)^{-1/2}
\]
и
\[
|n\rangle = (n!)^{-1/2} (\hat a^+)^n |0\rangle.
\]

Используя полученный набор векторов \(\{ |i\rangle | i \in \bb N_0 \}\) в качестве базиса, конструируем
искомое гильбертово пространство. Такое пространство, полученное, как говорят, <<циклическим действием
оператора рождения на вакуум>>, называется \it{пространством Фока}.

Мы решили задачу о квантовом осцилляторе в представлении Фока. В этом представлении центральную роль
играют абстрактные операторы рождения и уничтожения: гильбертово пространство строится с их помощью, а все
операторы представляются как алгебраические выражения из этих операторов. Посмотрим теперь как та же
задача выглядит в других представлениях.

\section{Квантовый осциллятор в матричном представлении}

От представления Фока легко перейти в матричному представлению, когда гильбертово прстранство~--- это
пространство бесконечных вектор-столбцов из комплексных чисел, а операторы~--- бесконечные квадратные матрицы.

Так как найденные нами состояния \(|i\rangle\) ортонормированы, их удобно взять за базис.
Поэтому сопоставим состоянию \(|n\rangle\) вектор-столбец, где на \((n+1)\)-м месте стоит единица,
а все остальные компоненты равны нулю. Тогда матричными элементами любого оператора \(\hat x\) будет
матрица, составленная из амплитуд \(\langle i | \hat x | j \rangle\), а они одинаковы в любом представлении.

Найдём матричные элементы всех важных операторов, используя представление Фока.

Для оператора уничтожения ненулевыми будут только элементы вида
\begin{multline*}
\langle i | \hat a | i+1 \rangle = \\
= (i!)^{-1/2} ((i+1)!)^{-1/2} \langle 0 | \hat a^ i \hat a (\hat a^+)^{i+1} | 0 \rangle = \\
= ((i!)(i!)(i+1))^{-1/2} \langle 0 | \hat a^ i \hat a (\hat a^+)^{i+1} | 0 \rangle = \\
= (i!)^{-1}(i+1)^{-1/2} \langle 0 | \hat a^ i \hat a (\hat a^+)^{i+1} | 0 \rangle = \\
= (i!)^{-1}(i+1)^{-1/2} \langle 0 | \hat a^ i ((i+1) (\hat a^+)^i + (\hat a^+)^{i+1} \hat a) | 0 \rangle = \\
= (i!)^{-1}(i+1)^{-1/2} (i+1) \langle 0 | \hat a^ i (\hat a^+)^i | 0 \rangle = \\
= (i!)^{-1}(i+1)^{-1/2} (i+1)! \langle 0 | 0 \rangle = \\
= \sqrt{i+1},
\end{multline*}
значит
\begin{equation}
\langle i | \hat a | j \rangle = \sqrt{j} \delta_{i+1,j}.
\label{iaj}\end{equation}

Аналогично
\begin{equation}
\langle i | \hat a^+ | j \rangle = \sqrt{i} \delta_{i,j+1}.
\label{iapj}\end{equation}

Тогда
\begin{gather*}
\langle i | \hat q | j \rangle = \frac 1 {\sqrt{2m\omega}} \sqrt{\max(i,j)} \delta_{\min(i,j)+1,\max(i,j)}, \\
\langle i | \hat p | j \rangle
= \sign(i-j) i \sqrt{\frac {m\omega} 2} \sqrt{\max(i,j)} \delta_{\min(i,j)+1,\max(i,j)}.
\end{gather*}

Матричные элементы гамильтониана очевидны, но также могут быть получены матричным умножением
(\ref{iapj}) и (\ref{iaj}):
\[
\langle i | \hat H | j \rangle = (i+\frac 1 2)\omega \delta_{ij}.
\]

\section{Осциллятор в координатном представлении}

<\ldots>

\section{Проблема выбора представления}

В механике с конечным числом степеней свободы выбор нужного представления произволен, поскольку
все представления абсолютно эквиваленты. Но в теории поля число степеней свободы бесконечно, поэтому
существует бесконечное количество неэквивалентных представлений. Введение обрезания в области высоких
импульсов это исправляет, но всё равно нужно быть внимательным~--- хотя бы какой предел брать сначала,
а какой потом.

\section{TSVF}

\begin{tikzpicture}
\node[above] at (0, 0) {1};
\node at (0, 0) [circle,fill,inner sep=1.5pt]{};
\node[above] at (1, 0.5) {2};
\node at (1, 0.5) [circle,fill,inner sep=1.5pt]{};
\node[above] at (2, 2) {3};
\node at (2, 2) [circle,fill,inner sep=1.5pt]{};
\node[above] at (2, 1) {4};
\node at (2, 1) [circle,fill,inner sep=1.5pt]{};
\node[above] at (2, 0) {5};
\node at (2, 0) [circle,fill,inner sep=1.5pt]{};
\node[above] at (2, -2) {6};
\node at (2, -2) [circle,fill,inner sep=1.5pt]{};
\draw (0, 0) parabola (2, 2);
\draw (0, 0) -- (2, 0);
\draw (0, 0) parabola (2, -2);
\draw (1, 0.5) -- (2, 1);
\end{tikzpicture}

\end{document}
